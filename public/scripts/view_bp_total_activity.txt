SELECT x.bp_pap_id,
  x.bp_activity_id,
  SUM(x.fy1_amount) AS fy1_amount,
  SUM(x.fy2_amount) AS fy2_amount,
  SUM(x.fy3_amount) AS fy3_amount
  FROM ((select
vw_bp_obj_exp.bp_pap_id,
  vw_bp_obj_exp.bp_activity_id,
  SUM(fy1_amount) AS fy1_amount,
  SUM(fy2_amount) AS fy2_amount,
  SUM(fy3_amount) AS fy3_amount
from
  view_bp_object_expenditure vw_bp_obj_exp
  WHERE
  vw_bp_obj_exp.expenditure_is_active = 1
  and vw_bp_obj_exp.expenditure_is_deleted = 0
  and vw_bp_obj_exp.expense_account_is_active = 1
  and vw_bp_obj_exp.expense_account_is_deleted = 0
  and vw_bp_obj_exp.activity_is_active = 1
  and vw_bp_obj_exp.activity_is_deleted = 0
  and vw_bp_obj_exp.subactivity_is_active = 1
  and vw_bp_obj_exp.subactivity_is_deleted = 0
  and vw_bp_obj_exp.pap_is_active = 1
  and vw_bp_obj_exp.pap_is_deleted = 0)
  
  UNION
  
  (select
vw_bp_obj_exp.bp_pap_id,
  vw_bp_obj_exp.bp_activity_id,
  SUM(fy1_amount) AS fy1_amount,
  SUM(fy2_amount) AS fy2_amount,
  SUM(fy3_amount) AS fy3_amount
from
  view_bp_object_expenditure vw_bp_obj_exp
  WHERE
  vw_bp_obj_exp.expenditure_is_active = 1
  and vw_bp_obj_exp.expenditure_is_deleted = 0
  and vw_bp_obj_exp.expense_account_is_active = 1
  and vw_bp_obj_exp.expense_account_is_deleted = 0
  and vw_bp_obj_exp.activity_is_active = 1
  and vw_bp_obj_exp.activity_is_deleted = 0
  and subactivity_is_active IS NULL
  and vw_bp_obj_exp.pap_is_active = 1
  and vw_bp_obj_exp.pap_is_deleted = 0)) x 


  **add on query 
  
  WHERE x.bp_activity_id=2 GROUP BY x.bp_activity_id;


  ***new

    SELECT
    *
  FROM
      `view_bp_object_expenditure`
  WHERE 
      (expense_account_is_active = 1 and expense_account_is_deleted=0)
      AND (expenditure_is_active = 1 and expenditure_is_deleted=0)
      AND (activity_is_active = 1  and activity_is_deleted=0)
      AND ((subactivity_is_active = 1 AND subactivity_is_deleted = 0 ) OR subactivity_is_active IS NULL) 
      AND (pap_is_active = 1 AND pap_is_deleted=0);