        SELECT
            bp.division_id,
            divi.division_acronym,
            year,            

            bp.id AS bp_id,
            bp_pap.id AS bp_pap_id,  
            bp_act.id AS bp_activity_id, 
            bp_subact.id AS bp_subactivity_id,
            bp_exp_acc.id AS bp_expense_account_id,
            bp_obj_exp.id AS bp_object_expenditure_id,

            lib_obj_exp.allotment_class_id,
            aclass.allotment_class,
            lib_pap.id AS pap_id,   
            lib_act.id AS activity_id,
            lib_subact.id AS subactivity_id,
            lib_exp_acc.id AS expense_account_id,
            lib_obj_exp.id AS object_expenditure_id,   
            bp_obj_exp.object_specific_id AS object_specific_id, 
            bp_obj_exp.pooled_at_division_id, 
           
            lib_pap.pap_code,    
            lib_pap.pap,        
            lib_act.activity AS activity,              
            lib_subact.subactivity AS subactivity,
            lib_exp_acc.expense_account AS expense_account,
            lib_exp_acc.expense_account_code AS expense_account_code,
            lib_obj_exp.object_expenditure AS object_expenditure,
            lib_obj_exp.object_code AS object_code,   
            lib_obj_spe.object_specific AS object_specific,
            pooled_divi.division_acronym AS pooled_at_division_acronym,
            
            fy1_amount,
            fy2_amount,
            fy3_amount,
            bp_obj_exp.comments_by_division_director,
            bp_obj_exp.comments_by_fad_budget,

            bp_obj_exp.remarks AS remarks,
            bp_obj_exp.tags AS tags,            
            lib_obj_exp.is_continuing AS is_continuing,

            bp_pap.is_active AS pap_is_active,
            bp_pap.is_deleted AS pap_is_deleted, 

            bp_act.is_active AS activity_is_active,
            bp_act.is_deleted AS activity_is_deleted, 

            bp_subact.is_active AS subactivity_is_active,
            bp_subact.is_deleted AS subactivity_is_deleted,   

            bp_exp_acc.is_active AS expense_account_is_active,
            bp_exp_acc.is_deleted AS expense_account_is_deleted,      

            bp_obj_exp.is_active AS expenditure_is_active,
            bp_obj_exp.is_deleted AS expenditure_is_deleted,
            bp_obj_exp.created_at AS created_at,
            bp_obj_exp.updated_at AS updated_at
        FROM bp_object_expenditure bp_obj_exp
        JOIn fmsdb.bp_expense_account bp_exp_acc ON bp_obj_exp.bp_expense_account_id=bp_exp_acc.id
        LEFT JOIN fmsdb.bp_subactivity bp_subact ON bp_exp_acc.bp_subactivity_id = bp_subact.id
        JOIN fmsdb.bp_activity bp_act ON bp_subact.bp_activity_id = bp_act.id
        JOIN fmsdb.bp_pap ON bp_act.bp_pap_id = bp_pap.id

        LEFT JOIN library_object_specific lib_obj_spe ON bp_obj_exp.object_specific_id=lib_obj_spe.id
        JOIN library_object_expenditure lib_obj_exp ON bp_obj_exp.object_expenditure_id=lib_obj_exp.id
        JOIN fmsdb.library_expense_account lib_exp_acc ON bp_exp_acc.expense_account_id = lib_exp_acc.id
        JOIN fmsdb.library_subactivity lib_subact ON bp_subact.subactivity_id = lib_subact.id
        JOIN fmsdb.library_activity lib_act ON bp_act.activity_id = lib_act.id
        JOIN fmsdb.library_pap lib_pap ON bp_pap.pap_id = lib_pap.id
        JOIN budget_proposals bp ON bp_pap.budget_proposal_id=bp.id
        LEFT JOIN commonlibrariesdb.pcaarrd_divisions divi ON bp.division_id=divi.id 
        LEFT JOIN commonlibrariesdb.pcaarrd_divisions pooled_divi ON bp_obj_exp.pooled_at_division_id=pooled_divi.id 
        LEFT JOIN library_allotment_class aclass ON lib_obj_exp.allotment_class_id=aclass.id
        where bp_exp_acc.bp_subactivity_id IS NOT NULL

        UNION

        SELECT
            bp.division_id,
            divi.division_acronym,
            year, 
            
            bp.id AS bp_id,
            bp_pap.id AS bp_pap_id,  
            bp_act.id AS bp_activity_id, 
            NULL AS bp_subactivity_id,
            bp_exp_acc.id AS bp_expense_account_id,
            bp_obj_exp.id AS bp_object_expenditure_id,

            lib_obj_exp.allotment_class_id,
            aclass.allotment_class,
            lib_pap.id AS pap_id,   
            lib_act.id AS activity_id,
            NULL AS subactivity_id,
            lib_exp_acc.id AS expense_account_id,
            lib_obj_exp.id AS object_expenditure_id,
            bp_obj_exp.object_specific_id AS object_specific_id,     
            bp_obj_exp.pooled_at_division_id,    
           
            lib_pap.pap_code,    
            lib_pap.pap,        
            lib_act.activity AS activity,              
            NULL AS subactivity,
            lib_exp_acc.expense_account AS expense_account,
            lib_exp_acc.expense_account_code AS expense_account_code,
            lib_obj_exp.object_expenditure AS object_expenditure,
            lib_obj_exp.object_code AS object_code,   
            lib_obj_spe.object_specific AS object_specific,
             pooled_divi.division_acronym AS pooled_at_division_acronym,

            fy1_amount,
            fy2_amount,
            fy3_amount,
            bp_obj_exp.comments_by_division_director,
            bp_obj_exp.comments_by_fad_budget,
            bp_obj_exp.remarks AS remarks,
            bp_obj_exp.tags AS tags,
            lib_obj_exp.is_continuing AS is_continuing,

            bp_pap.is_active AS pap_is_active,
            bp_pap.is_deleted AS pap_is_deleted, 

            bp_act.is_active AS activity_is_active,
            bp_act.is_deleted AS activity_is_deleted, 

            NULL AS subactivity_is_active,
            NULL AS subactivity_is_deleted,   

            bp_exp_acc.is_active AS expense_account_is_active,
            bp_exp_acc.is_deleted AS expense_account_is_deleted, 

            bp_obj_exp.is_active AS expenditure_is_active,
            bp_obj_exp.is_deleted AS expenditure_is_deleted,
            bp_obj_exp.created_at AS created_at,
            bp_obj_exp.updated_at AS updated_at
        FROM bp_object_expenditure bp_obj_exp
        JOIn fmsdb.bp_expense_account bp_exp_acc ON bp_obj_exp.bp_expense_account_id=bp_exp_acc.id
        JOIN fmsdb.bp_activity bp_act ON bp_exp_acc.bp_activity_id = bp_act.id
        JOIN fmsdb.bp_pap ON bp_act.bp_pap_id = bp_pap.id

        LEFT JOIN library_object_specific lib_obj_spe ON bp_obj_exp.object_specific_id=lib_obj_spe.id
        JOIN library_object_expenditure lib_obj_exp ON bp_obj_exp.object_expenditure_id=lib_obj_exp.id
        JOIN fmsdb.library_expense_account lib_exp_acc ON bp_exp_acc.expense_account_id = lib_exp_acc.id
        JOIN fmsdb.library_activity lib_act ON bp_act.activity_id = lib_act.id
        JOIN fmsdb.library_pap lib_pap ON bp_pap.pap_id = lib_pap.id
        JOIN budget_proposals bp ON bp_pap.budget_proposal_id=bp.id 
        LEFT JOIN commonlibrariesdb.pcaarrd_divisions divi ON bp.division_id=divi.id 
        LEFT JOIN commonlibrariesdb.pcaarrd_divisions pooled_divi ON bp_obj_exp.pooled_at_division_id=pooled_divi.id 
        LEFT JOIN library_allotment_class aclass ON lib_obj_exp.allotment_class_id=aclass.id
        where bp_exp_acc.bp_subactivity_id IS NULL
        

            
        
    
    
        
    