SELECT
    dv.id AS id,    
    dv.dv_no AS dv_no,
    (CASE WHEN(dv.dv_date1 IS NULL) THEN dv.dv_date ELSE dv.dv_date1 END) as dv_date,
    dv.division_id AS dv_division_id,
    divi.division_acronym AS dv_division_acronym,
    dv.fund_id AS fund_id,
    fund,
    rs.id as rs_id,
    (CASE WHEN(rs.rs_date IS NULL) THEN rs.rs_date ELSE rs.rs_date END) as rs_date,
    rs_no,
    rs.division_id AS rs_division_id,
    divi1.division_acronym AS rs_division_acronym,
    rs.total_rs_pap_amount,
    pap_code,
    activity,
    subactivity,    
    expense_account,    
    object_expenditure,
    expense_account_code,
    object_code,    
    (CASE WHEN(object_expenditure IS NULL) THEN expense_account ELSE object_expenditure END) AS accnt_obj,
    (CASE WHEN(object_expenditure IS NULL) THEN expense_account_code ELSE object_code END) AS accnt_obj_code,
    lddap.id as lddap_id,
    lddap_no as lddap_check_no,
    lddap_date as  lddap_check_date,
    ada.id as ada_check_id,
    ada_no as ada_check_no,
    ada_date as ada_check_date,
    date_transferred as date_transferred,
    dv.payee_id AS payee_id,
    payees.parent_id as payee_parent_id,
    payee, 
    dv.particulars AS particulars,

    SUM(tax_one) AS tax_one,
    SUM(tax_two) AS tax_two,
    SUM(tax_twob) AS tax_twob,
    SUM(tax_three) AS tax_three,
    SUM(tax_five) AS tax_five,
    SUM(tax_six) AS tax_six,
    SUM(wtax) AS wtax,
    SUM(other_tax) AS other_tax,
    SUM(liquidated_damages) AS liquidated_damages,
    SUM(other_deductions) AS other_deductions,
    dv.total_dv_gross_amount as total_dv_gross_amount,
    dv.total_dv_net_amount as total_dv_net_amount, 

    payees.bank AS payee_bank,
    payees.bank_acronym AS payee_bank_acronym,
    payees.bank_short_name AS payee_bank_short_name,
    bank_branch as payee_bank_branch,
    bank_account_name as payee_bank_account_name,
    bank_account_name1 as payee_bank_account_name1,
    bank_account_name2 as payee_bank_account_name2,
    payees.bank_account_no AS payee_bank_account_no,
    payees.tin AS tin,
    payees.address AS address,
    payees.contact_no AS contact_no,
    payees.for_remit AS for_remit,
    payees.bg_color AS bg_color,
    dv.signatory1 AS signatory1,
    dv.signatory1_position AS signatory1_position,
    dv.signatory2 AS signatory2,
    dv.signatory2_position AS signatory2_position,
    dv.signatory3 AS signatory3,
    dv.signatory3_position AS signatory3_position,    
    dv.date_out AS date_out,
    dv.out_to AS out_to,
    dv.received_from AS received_from,
    dv.date_returned AS date_returned,
    dv.tax_type_id AS tax_type_id,
    dv.pay_type_id AS pay_type_id,
    dv.po_no AS po_no,
    dv.po_date AS po_date,
    dv.invoice_no AS invoice_no,
    dv.invoice_date AS invoice_date,
    dv.cod_no AS cod_no,
    dv.jobcon_no AS jobcon_no,
    dv.jobcon_date AS jobcon_date,
    dv.or_no AS or_no,
    dv.or_date AS or_date,
    dv.is_locked AS is_locked,
    dv.is_active AS is_active,
    dv.is_deleted AS is_deleted,
    dv.created_at AS created_at,
    dv.updated_at AS updated_at
FROM disbursement_vouchers dv
LEFT JOIN dv_rs_net dvnet on dv.id=dvnet.dv_id
LEFT JOIN commonlibrariesdb.pcaarrd_divisions divi ON dv.division_id = divi.id
LEFT JOIN commonlibrariesdb.funds ON  dv.fund_id = commonlibrariesdb.funds.id
LEFT JOIN view_library_payees payees ON dv.payee_id = payees.id
LEFT JOIN request_status rs ON dvnet.rs_id=rs.id
LEFT JOIN rs_pap rsp on dvnet.rs_id=rsp.rs_id
LEFT JOIN commonlibrariesdb.pcaarrd_divisions divi1 ON rs.division_id = divi1.id
LEFT JOIN view_allotment a on rsp.allotment_id=a.id
LEFT JOIN lddap ON dv.lddap_id = lddap.id
LEFT JOIN ada ON lddap.ada_id=ada.id
WHERE dvnet.is_active=1 and dvnet.is_deleted=0
GROUP BY dv.id

UNION

SELECT
    dv.id AS id,    
    dv.dv_no AS dv_no,
    (CASE WHEN(dv.dv_date1 IS NULL) THEN dv.dv_date ELSE dv.dv_date1 END) as dv_date,
    dv.division_id AS division_id,
    divi.division_acronym AS division_acronym,
    dv.fund_id AS fund_id,
    fund,
    rs.id as rs_id,
    (CASE WHEN(rs.rs_date IS NULL) THEN rs.rs_date ELSE rs.rs_date END) as rs_date,
    rs_no,
    rs.division_id AS rs_division_id,
    divi1.division_acronym AS rs_division_acronym,
    rs.total_rs_pap_amount,
    pap_code,
    activity,
    subactivity,    
    expense_account,    
    object_expenditure,
    expense_account_code,
    object_code,
    (CASE WHEN(object_expenditure IS NULL) THEN expense_account ELSE object_expenditure END) AS accnt_obj,
    (CASE WHEN(object_expenditure IS NULL) THEN expense_account_code ELSE object_code END) AS accnt_obj_code,
    c.id as lddap_id,
    c.check_no as lddap_check_no,
    c.check_date as lddap_check_date,
    c.id as ada_check_id,
    c.check_no as ada_check_no,
    c.check_date as ada_check_date,
    c.date_released as date_transferred,
    dv.payee_id AS payee_id,
    payees.parent_id as payee_parent_id,
    payee, 
    dv.particulars AS particulars,

    SUM(tax_one) AS tax_one,
    SUM(tax_two) AS tax_two,
    SUM(tax_twob) AS tax_twob,
    SUM(tax_three) AS tax_three,
    SUM(tax_five) AS tax_five,
    SUM(tax_six) AS tax_six,
    SUM(wtax) AS wtax,
    SUM(other_tax) AS other_tax,
    SUM(liquidated_damages) AS liquidated_damages,
    SUM(other_deductions) AS other_deductions,
    dv.total_dv_gross_amount as total_dv_gross_amount,
    dv.total_dv_net_amount as total_dv_net_amount,   

    payees.bank AS payee_bank,
    payees.bank_acronym AS payee_bank_acronym,
    payees.bank_short_name AS payee_bank_short_name,
    bank_branch as payee_bank_branch,
    bank_account_name as payee_bank_account_name,
    bank_account_name1 as payee_bank_account_name1,
    bank_account_name2 as payee_bank_account_name2,
    payees.bank_account_no AS payee_bank_account_no,
    payees.tin AS tin,
    payees.address AS address,
    payees.contact_no AS contact_no,
    payees.for_remit AS for_remit,
    payees.bg_color AS bg_color,
    dv.signatory1 AS signatory1,
    dv.signatory1_position AS signatory1_position,
    dv.signatory2 AS signatory2,
    dv.signatory2_position AS signatory2_position,
    dv.signatory3 AS signatory3,
    dv.signatory3_position AS signatory3_position,    
    dv.date_out AS date_out,
    dv.out_to AS out_to,
    dv.received_from AS received_from,
    dv.date_returned AS date_returned,
    dv.tax_type_id AS tax_type_id,
    dv.pay_type_id AS pay_type_id,
    dv.po_no AS po_no,
    dv.po_date AS po_date,
    dv.invoice_no AS invoice_no,
    dv.invoice_date AS invoice_date,
    dv.cod_no AS cod_no,
    dv.jobcon_no AS jobcon_no,
    dv.jobcon_date AS jobcon_date,
    dv.or_no AS or_no,
    dv.or_date AS or_date,
    dv.is_locked AS is_locked,
    dv.is_active AS is_active,
    dv.is_deleted AS is_deleted,
    dv.created_at AS created_at,
    dv.updated_at AS updated_at
FROM disbursement_vouchers dv
LEFT JOIN dv_rs_net dvnet on dv.id=dvnet.dv_id
LEFT JOIN commonlibrariesdb.pcaarrd_divisions divi ON dv.division_id = divi.id
LEFT JOIN commonlibrariesdb.funds ON  dv.fund_id = commonlibrariesdb.funds.id
LEFT JOIN view_library_payees payees ON dv.payee_id = payees.id
LEFT JOIN request_status rs ON dvnet.rs_id=rs.id
LEFT JOIN rs_pap rsp on dvnet.rs_id=rsp.rs_id
LEFT JOIN commonlibrariesdb.pcaarrd_divisions divi1 ON rs.division_id = divi1.id
LEFT JOIN view_allotment a on rsp.allotment_id=a.id
LEFT JOIN checks c ON dv.id=c.dv_id
WHERE dvnet.is_active=1 and dvnet.is_deleted=0
GROUP BY dv.id